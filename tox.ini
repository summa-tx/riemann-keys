[tox]
envlist = cov-init, py3{7}, cov-report

[pytest]
nonrecursedirs = .git .tox coverage

[testenv]
usedevelop=True
setenv =
    COVERAGE_FILE = .coverage.{envname}
deps = pipenv

commands =
   pipenv install --dev --ignore-pipfile
   pipenv run flake8 --version
   pipenv run flake8 setup.py

[testenv:flake8]
deps = flake8
commands = flake8 --ignore=W503 riemann_keys

[testenv:cov-init]
setenv =
    COVERAGE_FILE = .coverage
deps = coverage
commands =
    coverage erase

[testenv:cov-report]
setenv =
    COVERAGE_FILE = .coverage
deps = coverage
commands =
    coverage combine
    coverage report
    coverage html
